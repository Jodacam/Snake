<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>

<head>
    <title>TODO supply a title</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    
    <script>
        var name;
         function CargarPartidas(e){
            $.ajax({
                method: "GET",
                url: "http://" + window.location.host + "/games/"
            })
                .done(function (msg) {
                    let template = $("#template").html();
                    $("#Partidas").html("");
                    for(var m of msg){
                        let n =  m.split(",");
                        let newTemplate =template.replace("%Name", n[0]);
                        newTemplate = newTemplate.replace("%Jugadores", n[1]);
                        $("#Partidas").append(newTemplate);
                    }
                });

        }


        $(function () {
            name = window.sessionStorage.getItem("name");
            $("#name").html(name);

            CargarPartidas(null);

            $("#Inputs").hide();
            $("#Crear").click(function(e){
                 $("#Inputs").show();
            });
            $("#CreaPartida").click(function(e){
                let n = $("#names").val();
                $.ajax({
                method: "POST",
                url: "http://"+window.location.host+"/games/",
                data: n              
                })
                .done(function (msg) {
                    alert("Data Saved: " + msg);
                });
            });

            $("#Recargar").click(CargarPartidas);
        });


       




    </script>


    <div>
        <h id="name">
        </h>
    </div>
    <div>Partidas</div>
    <button id="Crear">Crear Partida</button>
    <div id = "Inputs">
        <input id ="names" type="text"></input>
        <button id ="CreaPartida">Continuar</button>
    </div>
    <button id="UnirseAletorio">Buscame Partida</button>
    <button id="Recargar">Recargar</button>
    <div id ="Partidas">

    </div>


    <script id ="template">
        <div>
            <h2>%Name</h2>
            <h>Numero de jugadores : %Jugadores</h>
        </div>
    
    </script>


</body>

</html>